<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8"/><link href="../../../../bootstrap-combined.min.css" rel="stylesheet" /><script type="text/javascript" src="../../../../jquery-1.9.1.min.js"></script><script type="text/javascript" src="../../../../bootstrap.min.js"></script><link href="../../../../styles.css" rel="stylesheet" /><link rel="icon" href="../../../../favicon.ico" type="image/x-icon"></link><script type="text/javascript" src="../../../../nav.js"></script><script type="text/javascript" src="../../../../index.js"></script><script type="text/javascript">var dox = {rootPath: "../../../../",platforms: ["documentation"]};</script><title>BetterCharacterControl - Angle3D</title></head><body><div class="navbar navbar-inverse navbar-fixed-top"><div class="navbar-inner"><form class="navbar-search pull-left" id="searchForm"><input id="search" type="text" class="search-query" placeholder="Filter" autocomplete="off"/></form><ul class="nav"><li id="select-platform" class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Platform<b class="caret"></b></a><ul class="dropdown-menu"><li data="all"><a href="#">All Platforms</a></li><li data="documentation"><a href="#">documentation</a></li></ul></li></ul></div></div><div id="container"><div id="nav"></div><div id="content"><div class="header"><h1><code><span class="directive">class </span><span class="type">org.angle3d.bullet.control.BetterCharacterControl</span><span class="keyword"> extends</span> <a class="type" href="../../../../org/angle3d/bullet/control/AbstractPhysicsControl.html">AbstractPhysicsControl</a><span class="keyword"> implements</span> <a class="type" href="../../../../org/angle3d/bullet/PhysicsTickListener.html">PhysicsTickListener</a></code></h1></div><div class="body"><p class="availability">Available on all platforms</p><div class="doc"><p>This is intended to be a replacement for the internal bullet character class.
A RigidBody with cylinder collision shape is used and its velocity is set
continuously, a ray test is used to check if the character is on the ground.</p>
<p>The character keeps his own local coordinate system which adapts based on the
gravity working on the character so the character will always stand upright.</p>
<p>Forces in the local x/z plane are dampened while those in the local y
direction are applied fully (e.g. jumping, falling).</p>
<p>@author normenhansen</p></div><h2>Instance Fields</h2><div class="platform platform-documentation"><a name="new"></a><h3><p><code><span class="keyword">function</span> <a href="#new"><span class="identifier">new</span></a>(radius:<span class="type">Float</span>, height:<span class="type">Float</span>, mass:<span class="type">Float</span>):<span class="type">Void</span></code></p></h3><div class="doc"><p>Creates a new character with the given properties. Note that to avoid
issues the final height when ducking should be larger than 2x radius. The
jumpForce will be set to an upwards force of 5x mass.</p><table class="table table-condensed"><tbody><col width="10%"/>  <col width="100%"/><tr><td>radius</td><td></td></tr><tr><td>height</td><td></td></tr><tr><td>null</td><td><p>mass</p></td></tr></tbody></table></div></div><div class="platform platform-documentation"><a name="cloneForSpatial"></a><h3><p><code><span class="keyword">function</span> <a href="#cloneForSpatial"><span class="identifier">cloneForSpatial</span></a>(spatial:<a class="type" href="../../../../org/angle3d/scene/Spatial.html">Spatial</a>):<a class="type" href="../../../../org/angle3d/scene/control/Control.html">Control</a></code></p></h3><div class="doc"><p></p></div></div><div class="platform platform-documentation"><a name="getDuckedFactor"></a><h3><p><code><span class="keyword">function</span> <a href="#getDuckedFactor"><span class="identifier">getDuckedFactor</span></a>():<span class="type">Float</span></code></p></h3><div class="doc"><p>Gets the height multiplication factor for ducking.</p>
<p>@return</p></div></div><div class="platform platform-documentation"><a name="getGravity"></a><h3><p><code><span class="keyword">function</span> <a href="#getGravity"><span class="identifier">getGravity</span></a>(?store:<a class="type" href="../../../../org/angle3d/math/Vector3f.html">Vector3f</a>):<a class="type" href="../../../../org/angle3d/math/Vector3f.html">Vector3f</a></code></p></h3><div class="doc"><p>Get the current gravity of the character.</p>
<p>@return</p><table class="table table-condensed"><tbody><col width="10%"/>  <col width="100%"/><tr><td>store</td><td><p>The vector to store the result in</p></td></tr></tbody></table></div></div><div class="platform platform-documentation"><a name="getJumpForce"></a><h3><p><code><span class="keyword">function</span> <a href="#getJumpForce"><span class="identifier">getJumpForce</span></a>():<a class="type" href="../../../../org/angle3d/math/Vector3f.html">Vector3f</a></code></p></h3><div class="doc"><p>Gets the current jump force. The default is 5 * character mass in y
direction.</p>
<p>@return</p></div></div><div class="platform platform-documentation"><a name="getPhysicsDamping"></a><h3><p><code><span class="keyword">function</span> <a href="#getPhysicsDamping"><span class="identifier">getPhysicsDamping</span></a>():<span class="type">Float</span></code></p></h3><div class="doc"><p>Gets how much the physics forces in the local x/z plane should be
dampened.</p></div></div><div class="platform platform-documentation"><a name="getVelocity"></a><h3><p><code><span class="keyword">function</span> <a href="#getVelocity"><span class="identifier">getVelocity</span></a>():<a class="type" href="../../../../org/angle3d/math/Vector3f.html">Vector3f</a></code></p></h3><div class="doc"><p>Get the current linear velocity along the three axes of the character.
This is prepresented in world coordinates, parent coordinates when the
control is set to applyLocalPhysics.</p><table class="table table-condensed"><tbody><col width="10%"/>  <col width="100%"/><tr><td>returns</td><td><p>The current linear velocity of the character</p></td></tr></tbody></table></div></div><div class="platform platform-documentation"><a name="getViewDirection"></a><h3><p><code><span class="keyword">function</span> <a href="#getViewDirection"><span class="identifier">getViewDirection</span></a>():<a class="type" href="../../../../org/angle3d/math/Vector3f.html">Vector3f</a></code></p></h3><div class="doc"><p>Gets the current view direction, note this doesn't need to correspond
with the spatials forward direction.</p>
<p>@return</p></div></div><div class="platform platform-documentation"><a name="getWalkDirection"></a><h3><p><code><span class="keyword">function</span> <a href="#getWalkDirection"><span class="identifier">getWalkDirection</span></a>():<a class="type" href="../../../../org/angle3d/math/Vector3f.html">Vector3f</a></code></p></h3><div class="doc"><p>Gets the current walk direction and speed of the character. The length of
the vector defines the speed.</p>
<p>@return</p></div></div><div class="platform platform-documentation"><a name="isDucked"></a><h3><p><code><span class="keyword">function</span> <a href="#isDucked"><span class="identifier">isDucked</span></a>():<span class="type">Bool</span></code></p></h3><div class="doc"><p>Check if the character is ducking, either due to user input or due to
unducking being impossible at the moment (obstacle above).</p>
<p>@return</p></div></div><div class="platform platform-documentation"><a name="isOnGround"></a><h3><p><code><span class="keyword">function</span> <a href="#isOnGround"><span class="identifier">isOnGround</span></a>():<span class="type">Bool</span></code></p></h3><div class="doc"><p>Check if the character is on the ground. This is determined by a ray test
in the center of the character and might return false even if the
character is not falling yet.</p>
<p>@return</p></div></div><div class="platform platform-documentation"><a name="jump"></a><h3><p><code><span class="keyword">function</span> <a href="#jump"><span class="identifier">jump</span></a>():<span class="type">Void</span></code></p></h3><div class="doc"><p>Makes the character jump with the set jump force.</p></div></div><div class="platform platform-documentation"><a name="physicsTick"></a><h3><p><code><span class="keyword">function</span> <a href="#physicsTick"><span class="identifier">physicsTick</span></a>(space:<a class="type" href="../../../../org/angle3d/bullet/PhysicsSpace.html">PhysicsSpace</a>, tpf:<span class="type">Float</span>):<span class="type">Void</span></code></p></h3><div class="doc"><p>Used internally, don't call manually</p><table class="table table-condensed"><tbody><col width="10%"/>  <col width="100%"/><tr><td>space</td><td></td></tr><tr><td>null</td><td><p>tpf</p></td></tr></tbody></table></div></div><div class="platform platform-documentation"><a name="prePhysicsTick"></a><h3><p><code><span class="keyword">function</span> <a href="#prePhysicsTick"><span class="identifier">prePhysicsTick</span></a>(space:<a class="type" href="../../../../org/angle3d/bullet/PhysicsSpace.html">PhysicsSpace</a>, tpf:<span class="type">Float</span>):<span class="type">Void</span></code></p></h3><div class="doc"><p>Used internally, don't call manually</p><table class="table table-condensed"><tbody><col width="10%"/>  <col width="100%"/><tr><td>space</td><td></td></tr><tr><td>null</td><td><p>tpf</p></td></tr></tbody></table></div></div><div class="platform platform-documentation"><a name="resetForward"></a><h3><p><code><span class="keyword">function</span> <a href="#resetForward"><span class="identifier">resetForward</span></a>(vec:<a class="type" href="../../../../org/angle3d/math/Vector3f.html">Vector3f</a>):<span class="type">Void</span></code></p></h3><div class="doc"><p>Realign the local forward vector to given direction vector, if null is
supplied Vector3f.UNIT_Z is used. Input vector has to be perpendicular to
current gravity vector. This normally only needs to be called when the
gravity direction changed continuously and the local forward vector is
off due to drift. E.g. after walking around on a sphere "planet" for a
while and then going back to a y-up coordinate system the local z-forward
might not be 100% alinged with Z axis.</p><table class="table table-condensed"><tbody><col width="10%"/>  <col width="100%"/><tr><td>vec</td><td><p>The new forward vector, has to be perpendicular to the current
gravity vector!</p></td></tr></tbody></table></div></div><div class="platform platform-documentation"><a name="setDucked"></a><h3><p><code><span class="keyword">function</span> <a href="#setDucked"><span class="identifier">setDucked</span></a>(enabled:<span class="type">Bool</span>):<span class="type">Void</span></code></p></h3><div class="doc"><p>Toggle character ducking. When ducked the characters capsule collision
shape height will be multiplied by duckedFactor to make the capsule
smaller. When unducking, the character will check with a ray test if it
can in fact unduck and only do so when its possible. You can check the
state of the unducking by checking isDucked().</p><table class="table table-condensed"><tbody><col width="10%"/>  <col width="100%"/><tr><td>null</td><td><p>enabled</p></td></tr></tbody></table></div></div><div class="platform platform-documentation"><a name="setDuckedFactor"></a><h3><p><code><span class="keyword">function</span> <a href="#setDuckedFactor"><span class="identifier">setDuckedFactor</span></a>(factor:<span class="type">Float</span>):<span class="type">Void</span></code></p></h3><div class="doc"><p>Sets the height multiplication factor for ducking.</p><table class="table table-condensed"><tbody><col width="10%"/>  <col width="100%"/><tr><td>factor</td><td><p>The factor by which the height should be multiplied when
ducking</p></td></tr></tbody></table></div></div><div class="platform platform-documentation"><a name="setGravity"></a><h3><p><code><span class="keyword">function</span> <a href="#setGravity"><span class="identifier">setGravity</span></a>(gravity:<a class="type" href="../../../../org/angle3d/math/Vector3f.html">Vector3f</a>):<span class="type">Void</span></code></p></h3><div class="doc"><p>Set the gravity for this character. Note that this also realigns the
local coordinate system of the character so that continuous changes in
gravity direction are possible while maintaining a sensible control over
the character.</p><table class="table table-condensed"><tbody><col width="10%"/>  <col width="100%"/><tr><td>null</td><td><p>gravity</p></td></tr></tbody></table></div></div><div class="platform platform-documentation"><a name="setJumpForce"></a><h3><p><code><span class="keyword">function</span> <a href="#setJumpForce"><span class="identifier">setJumpForce</span></a>(jumpForce:<a class="type" href="../../../../org/angle3d/math/Vector3f.html">Vector3f</a>):<span class="type">Void</span></code></p></h3><div class="doc"><p>Set the jump force as a Vector3f. The jump force is local to the
characters coordinate system, which normally is always z-forward (in
world coordinates, parent coordinates when set to applyLocalPhysics)</p><table class="table table-condensed"><tbody><col width="10%"/>  <col width="100%"/><tr><td>jumpForce</td><td><p>The new jump force</p></td></tr></tbody></table></div></div><div class="platform platform-documentation"><a name="setPhysicsDamping"></a><h3><p><code><span class="keyword">function</span> <a href="#setPhysicsDamping"><span class="identifier">setPhysicsDamping</span></a>(physicsDamping:<span class="type">Float</span>):<span class="type">Void</span></code></p></h3><div class="doc"><p>Sets how much the physics forces in the local x/z plane should be
dampened.</p><table class="table table-condensed"><tbody><col width="10%"/>  <col width="100%"/><tr><td>physicsDamping</td><td><p>The dampening value, 0 = no dampening, 1 = no external force, default = 0.9</p></td></tr></tbody></table></div></div><div class="platform platform-documentation"><a name="setViewDirection"></a><h3><p><code><span class="keyword">function</span> <a href="#setViewDirection"><span class="identifier">setViewDirection</span></a>(vec:<a class="type" href="../../../../org/angle3d/math/Vector3f.html">Vector3f</a>):<span class="type">Void</span></code></p></h3><div class="doc"><p>Sets the view direction for the character. Note this only defines the
rotation of the spatial in the local x/z plane of the character.</p><table class="table table-condensed"><tbody><col width="10%"/>  <col width="100%"/><tr><td>null</td><td><p>vec</p></td></tr></tbody></table></div></div><div class="platform platform-documentation"><a name="setWalkDirection"></a><h3><p><code><span class="keyword">function</span> <a href="#setWalkDirection"><span class="identifier">setWalkDirection</span></a>(vec:<a class="type" href="../../../../org/angle3d/math/Vector3f.html">Vector3f</a>):<span class="type">Void</span></code></p></h3><div class="doc"><p>Sets the walk direction of the character. This parameter is framerate
independent and the character will move continuously in the direction
given by the vector with the speed given by the vector length in m/s.</p><table class="table table-condensed"><tbody><col width="10%"/>  <col width="100%"/><tr><td>vec</td><td><p>The movement direction and speed in m/s</p></td></tr></tbody></table></div></div><div class="platform platform-documentation"><a name="update"></a><h3><p><code><span class="keyword">function</span> <a href="#update"><span class="identifier">update</span></a>(tpf:<span class="type">Float</span>):<span class="type">Void</span></code></p></h3><div class="doc"><p></p></div></div><div class="platform platform-documentation"><a name="warp"></a><h3><p><code><span class="keyword">function</span> <a href="#warp"><span class="identifier">warp</span></a>(vec:<a class="type" href="../../../../org/angle3d/math/Vector3f.html">Vector3f</a>):<span class="type">Void</span></code></p></h3><div class="doc"><p>Move the character somewhere. Note the character also takes the location
of any spatial its being attached to in the moment it is attached.</p><table class="table table-condensed"><tbody><col width="10%"/>  <col width="100%"/><tr><td>vec</td><td><p>The new character location.</p></td></tr></tbody></table></div></div></div></div></div></body></html>